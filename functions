function test_overcloud {
  nc=255
  echo "Testing overcloud ..."
  if [ -e ~/overcloudrc ]; then
    source ~/overcloudrc
    bash setup_images.sh
    nc=$?
    if [ $nc -eq 0 ]; then
      bash create_network.sh
      nc=$?
      if [ $nc -eq 0 ]; then
        bash boot_vm.sh
        nc=$?
      fi
    fi
  else
    echo "Something weird happened"
  fi
  return $nc
}

function delete_overcloud {
  echo "Deleting overcloud...."
  heat=$( heat stack-list | grep overcloud )
  if [ ! -z "$heat" ]; then
    heat stack-delete overcloud
    while [ ! -z "$heat" ]; do
      heat=$( heat stack-list | grep overcloud )
      echo -n "."
      if [[ "$heat" =~ FAILED ]]; then
        echo "Stack deletion failed... retrying!"
        heat stack-delete overcloud
        sleep 1
      fi
      sleep 1
    done
  fi
}

